{% extends 'admin_base.html' %}

{% block content %}
<div class="home-card">
  <h2>ðŸ“Š Statistik Pemesanan</h2>

  <form method="get" action="{{ url_for('admin_statistik') }}">
    <label for="bulan">Filter Bulan:</label>
    <select name="bulan" id="bulan" onchange="this.form.submit()">
      <option value="">ðŸ“… Semua</option>
      {% for i in range(1, 13) %}
        <option value="{{ i }}" {% if bulan_aktif == i %}selected{% endif %}>{{ i }} - {{ ["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"][i-1] }}</option>
      {% endfor %}
    </select>
  </form>

  <p>Bulan: <strong>{{ nama_bulan }}</strong></p>
  <p>Jumlah total pemesanan: <strong>{{ total_pemesanan }}</strong></p>
  <p>Total pendapatan: <strong>{{ total_pendapatan }}</strong></p>

  <canvas id="bookingChart" height="100"></canvas>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  const ctx = document.getElementById('bookingChart').getContext('2d');
  const bookingChart = new Chart(ctx, {
    type: 'bar',
    data: {
      labels: {{ chart_labels | tojson }},
      datasets: [{
        label: 'Pemesanan / Bulan',
        data: {{ chart_values | tojson }},
        backgroundColor: '#9a1750',
        borderColor: '#5f0f40',
        borderWidth: 1,
        borderRadius: 6,
      }]
    },
    options: {
      responsive: true,
      scales: {
        y: { beginAtZero: true, ticks: { color: '#f1f1f1' } },
        x: { ticks: { color: '#f1f1f1' } }
      },
      plugins: {
        legend: {
          labels: { color: '#e0aaff' }
        }
      }
    }
  });
</script>
{% endblock %}
